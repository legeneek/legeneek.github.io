webpackJsonp([0],[,function(t,i,e){e(8);var s=e(0)(e(4),e(13),null,null);t.exports=s.exports},,function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(2),r=e(1),n=e.n(r);s.a.config.productionTip=!1,new s.a({el:"#app",template:"<App/>",components:{App:n.a}})},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(10),r=e.n(s);i.default={name:"app",components:{CustomCropper:r.a}}},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(11),r=e.n(s);i.default={components:{SelectBox:r.a},data:function(){return{img:null,$srcImg:null,$resImg:null,$input:null,$imgContainer:null,$preContainer:null,nw:0,nh:0,clipData:null,ratio:1.6,imgSize:{w:0,h:0},containerTop:0}},mounted:function(){this.$input=this.$el.querySelectorAll("#file_input")[0],this.$srcImg=this.$el.querySelectorAll("#clip_src_img")[0],this.$resImg=this.$el.querySelectorAll("#clip_res_img")[0],this.$imgContainer=this.$el.querySelectorAll(".img-container")[0],this.$preContainer=this.$el.querySelectorAll(".pre-container")[0],this.$containerBox=this.$el.querySelectorAll(".container-bg")[0]},methods:{selectChange:function(){var t=this.$refs.box.rec;t.w>0&&t.h>0&&this.updatePreview()},selectEnd:function(){var t=this.$refs.box.rec;t.w>0&&t.h>0&&this.clip()},fileChange:function(){var t=this,i=new FileReader;i.onloadend=function(){t.img=i.result},this.$input.files&&this.$input.files[0]&&i.readAsDataURL(this.$input.files[0])},srcImgLoaded:function(){this.nw=this.$srcImg.naturalWidth,this.nh=this.$srcImg.naturalHeight,this.clearSelect(),this.setImgSize(),this.updatePreview(),this.clip()},clearSelect:function(){this.$refs.box.clearRec(),this.clipData=null},setImgSize:function(){var t=this.nw/this.nh,i=this.$containerBox.offsetWidth,e=this.$containerBox.offsetHeight,s=0,r=0;t>=this.ratio?(this.imgSize.w=i,this.imgSize.h=i/t,this.containerTop=(e-this.imgSize.h)/2,r=this.imgSize.h,s=r*this.ratio):(this.imgSize.h=e,this.imgSize.w=e*t,this.containerTop=0,s=this.imgSize.w,r=s/this.ratio),this.$srcImg.setAttribute("style","width:"+this.imgSize.w+"px;height:"+this.imgSize.h+"px;"),this.$imgContainer.setAttribute("style","width:"+this.imgSize.w+"px;height:"+this.imgSize.h+"px;top:"+this.containerTop+"px;"),this.$refs.box.rec={w:s,h:r,l:0,t:0}},getComputedRec:function(t){var i=this.$imgContainer.offsetWidth,e=this.$imgContainer.offsetHeight,s=i/this.nw,r=e/this.nh;return{l:t.l/s,t:t.t/r,w:t.w/s,h:t.h/r}},updatePreview:function(){var t=this.$refs.box.rec,i=this.$preContainer.offsetWidth,e=this.$preContainer.offsetHeight,s=i/t.w,r=e/t.h,n=s*this.$imgContainer.offsetWidth,o=r*this.$imgContainer.offsetHeight,h=-t.l*s,a=-t.t*r;this.$resImg.setAttribute("style","width:"+n+"px;height:"+o+"px;top:"+a+"px;left:"+h+"px;")},clip:function(){var t=this.$refs.box.rec;if(t.w&&t.h){var i=document.createElement("canvas"),e=i.getContext("2d"),s=this.getComputedRec(t);i.width=s.w,i.height=s.h,e.drawImage(this.$srcImg,-s.l,-s.t,this.nw,this.nh),this.clipData=i.toDataURL("image/jpeg",1)}}}}},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default={props:{ratio:{},img:{},srcSize:{}},data:function(){return{rec:{w:0,h:0,l:0,t:0},pl:0,pt:0,action:"",actionPoint:{x:0,y:0},referPoint:{x:0,y:0},$rec:null}},computed:{showBox:function(){return this.rec.w&&this.rec.h},imgStyle:function(){return"width:"+this.srcSize.w+"px;height:"+this.srcSize.h+"px;top:"+-this.rec.t+"px;left:"+-this.rec.l+"px;"},recStyle:function(){return"width:"+this.rec.w+"px;height:"+this.rec.h+"px;left:"+this.rec.l+"px;top:"+this.rec.t+"px;"}},mounted:function(){window.addEventListener("mouseup",this.disableDrag),window.addEventListener("mousemove",this.updateRec)},beforeDestroy:function(){window.removeEventListener("mouseup",this.disableDrag),window.removeEventListener("mousemove",this.updateRec)},methods:{getLeft:function(t){for(var i=t.offsetLeft,e=t.offsetParent;e;)i+=e.offsetLeft,e=e.offsetParent;return i},getTop:function(t){for(var i=t.offsetTop,e=t.offsetParent;e;)i+=e.offsetTop,e=e.offsetParent;return i},initAction:function(t,i,e){this.action=t,this.pl=this.getLeft(this.$el),this.pt=this.getTop(this.$el),this.actionPoint={x:i,y:e},this.referPoint={x:this.rec.l,y:this.rec.t},"drag-lt"===t?this.referPoint={x:this.rec.l+this.rec.w,y:this.rec.t+this.rec.h}:"drag-lb"===t?this.referPoint={x:this.rec.l+this.rec.w,y:this.rec.t}:"drag-rt"===t?this.referPoint={x:this.rec.l,y:this.rec.t+this.rec.h}:"drag-rb"===t&&(this.referPoint={x:this.rec.l,y:this.rec.t})},pointMouseDown:function(t,i){this.initAction(t,i.pageX,i.pageY),i.stopPropagation()},boxMouseDown:function(t){this.initAction("move",t.pageX,t.pageY),t.stopPropagation()},wrapMouseDown:function(t){this.rec.w&&this.rec.h||(this.initAction("cross",t.pageX,t.pageY),this.rec={w:0,h:0,l:t.pageX-this.pl,t:t.pageY-this.pt},t.stopPropagation())},disableDrag:function(){this.action&&(this.action="",this.$emit("selectEnd"))},clearRec:function(){this.action="",this.rec={w:0,h:0,l:0,t:0}},updateRec:function(t){if(this.action){var i=this.$el.offsetWidth,e=this.$el.offsetHeight,s=t.pageX-this.actionPoint.x,r=t.pageY-this.actionPoint.y,n=t.pageX,o=t.pageY,h=0,a=0,c=0,l=0;0===s&&0===r||("move"===this.action?(c=r+this.referPoint.y,l=s+this.referPoint.x,c<=0?c=0:c+this.rec.h>=e&&(c=e-this.rec.h),l<=0?l=0:l+this.rec.w>=i&&(l=i-this.rec.w),this.rec.l=l,this.rec.t=c):"cross"===this.action?s>0&&r>0?(h=s+this.rec.l>=i?i-this.rec.l:s,a=h/this.ratio,a+this.rec.t>e&&(a=e-this.rec.t,h=a*this.ratio),this.rec.w=h,this.rec.h=a):s>0&&r<0?(h=s+this.referPoint.x>=i?i-this.referPoint.x:s,a=h/this.ratio,a>=this.referPoint.y&&(a=this.referPoint.y,h=a*this.ratio),this.rec.t=this.referPoint.y-a,this.rec.w=h,this.rec.h=a):s<0&&r<0?(h=s+this.referPoint.x<=0?this.referPoint.x:-s,a=h/this.ratio,a>=this.referPoint.y&&(a=this.referPoint.y,h=a*this.ratio),this.rec.t=this.referPoint.y-a,this.rec.l=this.referPoint.x-h,this.rec.w=h,this.rec.h=a):s<0&&r>0&&(h=s+this.referPoint.x<=0?this.referPoint.x:-s,a=h/this.ratio,a+this.referPoint.y>=e&&(a=e-this.referPoint.y,h=a*this.ratio),this.rec.l=this.referPoint.x-h,this.rec.w=h,this.rec.h=a):"drag-lt"!==this.action&&"drag-rt"!==this.action&&"drag-lb"!==this.action&&"drag-rb"!==this.action||(h=n-(this.referPoint.x+this.pl),a=o-(this.referPoint.y+this.pt),h<0&&a<0?(h=h*-1>=this.referPoint.x?this.referPoint.x:h*-1,a=h/this.ratio,a>=this.referPoint.y&&(a=this.referPoint.y,h=a*this.ratio),this.rec.l=this.referPoint.x-h,this.rec.t=this.referPoint.y-a):h<0&&a>0?(h=h*-1>=this.referPoint.x?this.referPoint.x:h*-1,a=h/this.ratio,a>=e-this.referPoint.y&&(a=e-this.referPoint.y,h=a*this.ratio),this.rec.l=this.referPoint.x-h,this.rec.t=this.referPoint.y):h>0&&a<0?(h=h>=i-this.referPoint.x?i-this.referPoint.x:h,a=h/this.ratio,a>=this.referPoint.y&&(a=this.referPoint.y,h=a*this.ratio),this.rec.l=this.referPoint.x,this.rec.t=this.referPoint.y-a):h>0&&a>0&&(h=h>=i-this.referPoint.x?i-this.referPoint.x:h,a=h/this.ratio,a>=e-this.referPoint.y&&(a=e-this.referPoint.y,h=a*this.ratio),this.rec.l=this.referPoint.x,this.rec.t=this.referPoint.y),this.rec.w=h,this.rec.h=a),this.$emit("selectChange"))}}}}},function(t,i){},function(t,i){},function(t,i){},function(t,i,e){e(7);var s=e(0)(e(5),e(12),"data-v-230e4956",null);t.exports=s.exports},function(t,i,e){e(9);var s=e(0)(e(6),e(14),"data-v-73993fae",null);t.exports=s.exports},function(t,i){t.exports={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"cropper-modal"},[e("div",{staticClass:"overlay"}),t._v(" "),e("div",{staticClass:"modal"},[t._m(0),t._v(" "),e("div",{staticClass:"modal-content clearfix"},[e("div",{staticClass:"img-clip-wrap"},[e("div",{staticClass:"container-bg"},[e("div",{staticClass:"img-container"},[e("img",{attrs:{id:"clip_src_img",src:t.img},on:{load:t.srcImgLoaded}}),t._v(" "),e("div",{staticClass:"shadow-box"}),t._v(" "),e("Select-Box",{ref:"box",attrs:{srcSize:t.imgSize,ratio:t.ratio,img:t.img},on:{selectEnd:t.selectEnd,selectChange:t.selectChange}})],1)]),t._v(" "),e("div",{staticClass:"reset-img"},[e("i",{staticClass:"icon-reset"}),t._v(" "),e("span",[t._v("select image")]),t._v(" "),e("input",{attrs:{type:"file",id:"file_input",accept:"image/png,image/jpg,image/gif"},on:{change:t.fileChange}})])]),t._v(" "),e("div",{staticClass:"img-preview-wrap"},[e("div",{staticClass:"pre-container"},[e("img",{attrs:{id:"clip_res_img",src:t.img}})]),t._v(" "),e("div",{staticClass:"pre-info"},[t._v("preview")])])]),t._v(" "),e("div",{staticClass:"modal-footer"},[e("a",{staticClass:"modal-btn btn-confirm",attrs:{href:t.clipData,download:"crop.jpg"}},[t._v("clip")])])])])},staticRenderFns:[function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"modal-head"},[e("div",{staticClass:"head-wrap"},[t._v("title")])])}]}},function(t,i){t.exports={render:function(){var t=this,i=t.$createElement;return(t._self._c||i)("custom-cropper")},staticRenderFns:[]}},function(t,i){t.exports={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"crop-wrap",on:{mousedown:t.wrapMouseDown}},[e("div",{staticClass:"shadow-box",style:t.recStyle},[e("img",{staticClass:"shadow-img",style:t.imgStyle,attrs:{src:t.img}})]),t._v(" "),e("div",{staticClass:"crop-box",class:t.showBox?"show":"",style:t.recStyle,on:{mousedown:t.boxMouseDown}},[e("span",{staticClass:"drag-point point-lt",on:{mousedown:function(i){t.pointMouseDown("drag-lt",i)}}}),t._v(" "),e("span",{staticClass:"drag-point point-lb",on:{mousedown:function(i){t.pointMouseDown("drag-lb",i)}}}),t._v(" "),e("span",{staticClass:"drag-point point-rt",on:{mousedown:function(i){t.pointMouseDown("drag-rt",i)}}}),t._v(" "),e("span",{staticClass:"drag-point point-rb",on:{mousedown:function(i){t.pointMouseDown("drag-rb",i)}}})])])},staticRenderFns:[]}}],[3]);
//# sourceMappingURL=app.d4f1a4ff4b3f7612aec7.js.map
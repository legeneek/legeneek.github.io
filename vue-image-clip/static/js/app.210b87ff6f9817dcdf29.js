webpackJsonp([1,0],[function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}var r=i(13),o=s(r),n=i(10),h=s(n);new o["default"]({el:"body",components:{App:h["default"]}})},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(11),o=s(r);e["default"]={components:{CustomCropper:o["default"]}}},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(12),o=s(r);e["default"]={components:{SelectBox:o["default"]},data:function(){return{$srcImg:null,$resImg:null,img:null,$input:null,$imgContainer:null,$preContainer:null,nw:0,nh:0,clipData:null,radio:1.6}},events:{selectChange:function(){var t=this.$refs.box.rec;t.w>0&&t.h>0&&this.updatePreview()},selectEnd:function(){var t=this.$refs.box.rec;t.w>0&&t.h>0&&this.clip()}},watch:{img:function(t){this.$srcImg.src=t,this.$resImg.src=t}},ready:function(){this.$input=this.$el.querySelectorAll("#file_input")[0],this.$srcImg=this.$el.querySelectorAll("#clip_src_img")[0],this.$resImg=this.$el.querySelectorAll("#clip_res_img")[0],this.$imgContainer=this.$el.querySelectorAll(".img-container")[0],this.$preContainer=this.$el.querySelectorAll(".pre-container")[0],this.$containerBox=this.$el.querySelectorAll(".container-bg")[0]},beforeDestroy:function(){},methods:{fileChange:function(){var t=this,e=new FileReader;e.onloadend=function(){t.img=e.result},this.$input.files&&this.$input.files[0]&&e.readAsDataURL(this.$input.files[0])},srcImgLoaded:function(){this.nw=this.$srcImg.naturalWidth,this.nh=this.$srcImg.naturalHeight,this.clearSelect(),this.setImgSize(),this.updatePreview(),this.clip()},setImgSize:function(){var t=this.nw/this.nh,e=this.$containerBox.offsetWidth,i=this.$containerBox.offsetHeight,s=0,r=0,o=0,n=0,h=0;t>=this.radio?(s=e,r=e/t,o=(i-r)/2,h=r,n=h*this.radio):(r=i,s=i*t,n=s,h=n/this.radio),this.$imgContainer.setAttribute("style","width:"+s+"px;height:"+r+"px;top:"+o+"px;"),this.$refs.box.rec={w:n,h:h,l:0,t:0},this.$broadcast("imgSizeChange",{w:s,h:r})},clearSelect:function(){var t=this.$refs.box;t&&t.clearRec(),this.clipData=null},getComputedRec:function(t){var e=this.$imgContainer.offsetWidth,i=this.$imgContainer.offsetHeight,s=e/this.nw,r=i/this.nh;return{l:t.l/s,t:t.t/r,w:t.w/s,h:t.h/r}},updatePreview:function(){var t=this.$refs.box.rec,e=this.$preContainer.offsetWidth,i=this.$preContainer.offsetHeight,s=e/t.w,r=i/t.h,o=s*this.$imgContainer.offsetWidth,n=r*this.$imgContainer.offsetHeight,h=-t.l*s,a=-t.t*r;this.$resImg.setAttribute("style","width:"+o+"px;height:"+n+"px;top:"+a+"px;left:"+h+"px;")},clip:function(){var t=this.$refs.box.rec;if(t.w&&t.h){var e=document.createElement("canvas"),i=e.getContext("2d"),s=this.getComputedRec(t);e.width=s.w,e.height=s.h,i.drawImage(this.$srcImg,-s.l,-s.t,this.nw,this.nh),this.clipData=e.toDataURL("image/jpeg",1)}}}}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={props:{radio:{"default":1.6},img:{"default":""}},data:function(){return{rec:{w:0,h:0,l:0,t:0},pl:0,pt:0,action:"",actionPoint:{x:0,y:0},referPoint:{x:0,y:0},$rec:null}},computed:{showBox:function(){return this.rec.w&&this.rec.h}},watch:{rec:{handler:function(){this.drawRec()},deep:!0}},ready:function(){this.$rec=this.$el.querySelectorAll(".crop-box")[0],this.$img=this.$el.querySelectorAll(".shadow-img")[0],this.$shadowBox=this.$el.querySelectorAll(".shadow-box")[0],window.addEventListener("mouseup",this.disableDrag),window.addEventListener("mousemove",this.updateRec),this.$on("imgSizeChange",function(t){this.$img.style.width=t.w+"px",this.$img.style.height=t.h+"px"})},beforeDestory:function(){window.removeEventListener("mouseup",this.disableDrag),window.removeEventListener("mousemove",this.updateRec)},methods:{getLeft:function(t){for(var e=t.offsetLeft,i=t.offsetParent;i;)e+=i.offsetLeft,i=i.offsetParent;return e},getTop:function(t){for(var e=t.offsetTop,i=t.offsetParent;i;)e+=i.offsetTop,i=i.offsetParent;return e},initAction:function(t,e,i){this.action=t,this.pl=this.getLeft(this.$el),this.pt=this.getTop(this.$el),this.actionPoint={x:e,y:i},this.referPoint={x:this.rec.l,y:this.rec.t},"drag-lt"===t?this.referPoint={x:this.rec.l+this.rec.w,y:this.rec.t+this.rec.h}:"drag-lb"===t?this.referPoint={x:this.rec.l+this.rec.w,y:this.rec.t}:"drag-rt"===t?this.referPoint={x:this.rec.l,y:this.rec.t+this.rec.h}:"drag-rb"===t&&(this.referPoint={x:this.rec.l,y:this.rec.t})},pointMouseDown:function(t,e){this.initAction(t,e.pageX,e.pageY),e.stopPropagation()},boxMouseDown:function(t){this.initAction("move",t.pageX,t.pageY),t.stopPropagation()},wrapMouseDown:function(t){this.rec.w&&this.rec.h||(this.initAction("cross",t.pageX,t.pageY),this.rec={w:0,h:0,l:t.pageX-this.pl,t:t.pageY-this.pt},t.stopPropagation())},disableDrag:function(){this.action&&(this.action="",this.$dispatch("selectEnd"))},clearRec:function(){this.action="",this.rec={w:0,h:0,l:0,t:0}},updateRec:function(t){if(this.action){var e=this.$el.offsetWidth,i=this.$el.offsetHeight,s=t.pageX-this.actionPoint.x,r=t.pageY-this.actionPoint.y,o=t.pageX,n=t.pageY,h=0,a=0,c=0,l=0;0===s&&0===r||("move"===this.action?(c=r+this.referPoint.y,l=s+this.referPoint.x,c<=0?c=0:c+this.rec.h>=i&&(c=i-this.rec.h),l<=0?l=0:l+this.rec.w>=e&&(l=e-this.rec.w),this.rec.l=l,this.rec.t=c):"cross"===this.action?s>0&&r>0?(h=s+this.rec.l>=e?e-this.rec.l:s,a=h/this.radio,a+this.rec.t>i&&(a=i-this.rec.t,h=a*this.radio),this.rec.w=h,this.rec.h=a):s>0&&r<0?(h=s+this.referPoint.x>=e?e-this.referPoint.x:s,a=h/this.radio,a>=this.referPoint.y&&(a=this.referPoint.y,h=a*this.radio),this.rec.t=this.referPoint.y-a,this.rec.w=h,this.rec.h=a):s<0&&r<0?(h=s+this.referPoint.x<=0?this.referPoint.x:-s,a=h/this.radio,a>=this.referPoint.y&&(a=this.referPoint.y,h=a*this.radio),this.rec.t=this.referPoint.y-a,this.rec.l=this.referPoint.x-h,this.rec.w=h,this.rec.h=a):s<0&&r>0&&(h=s+this.referPoint.x<=0?this.referPoint.x:-s,a=h/this.radio,a+this.referPoint.y>=i&&(a=i-this.referPoint.y,h=a*this.radio),this.rec.l=this.referPoint.x-h,this.rec.w=h,this.rec.h=a):"drag-lt"!==this.action&&"drag-rt"!==this.action&&"drag-lb"!==this.action&&"drag-rb"!==this.action||(h=o-(this.referPoint.x+this.pl),a=n-(this.referPoint.y+this.pt),h<0&&a<0?(h=h*-1>=this.referPoint.x?this.referPoint.x:h*-1,a=h/this.radio,a>=this.referPoint.y&&(a=this.referPoint.y,h=a*this.radio),this.rec.l=this.referPoint.x-h,this.rec.t=this.referPoint.y-a):h<0&&a>0?(h=h*-1>=this.referPoint.x?this.referPoint.x:h*-1,a=h/this.radio,a>=i-this.referPoint.y&&(a=i-this.referPoint.y,h=a*this.radio),this.rec.l=this.referPoint.x-h,this.rec.t=this.referPoint.y):h>0&&a<0?(h=h>=e-this.referPoint.x?e-this.referPoint.x:h,a=h/this.radio,a>=this.referPoint.y&&(a=this.referPoint.y,h=a*this.radio),this.rec.l=this.referPoint.x,this.rec.t=this.referPoint.y-a):h>0&&a>0&&(h=h>=e-this.referPoint.x?e-this.referPoint.x:h,a=h/this.radio,a>=i-this.referPoint.y&&(a=i-this.referPoint.y,h=a*this.radio),this.rec.l=this.referPoint.x,this.rec.t=this.referPoint.y),this.rec.w=h,this.rec.h=a),this.$dispatch("selectChange"))}},drawRec:function(){this.$rec||(this.$rec=this.$el.querySelectorAll(".crop-box")[0]),this.$rec.setAttribute("style","width:"+this.rec.w+"px;height:"+this.rec.h+"px;\n          left:"+this.rec.l+"px;top:"+this.rec.t+"px;z-index:2;"),this.$shadowBox.setAttribute("style","width:"+this.rec.w+"px;height:"+this.rec.h+"px;\n          left:"+this.rec.l+"px;top:"+this.rec.t+"px;z-index:1;"),this.$img.style.left="-"+this.rec.l+"px",this.$img.style.top="-"+this.rec.t+"px"}}}},function(t,e){},function(t,e){},function(t,e){},function(t,e){t.exports=" <div id=app> <custom-cropper></custom-cropper> </div> "},function(t,e){t.exports=' <div class=crop-wrap @mousedown=wrapMouseDown _v-379c5928=""> <div class=shadow-box _v-379c5928=""> <img :src=img class=shadow-img _v-379c5928=""> </div> <div class=crop-box @mousedown=boxMouseDown :class="{\'show\': showBox}" _v-379c5928=""> <span class="drag-point point-lt" @mousedown="pointMouseDown(\'drag-lt\', $event)" _v-379c5928=""></span> <span class="drag-point point-lb" @mousedown="pointMouseDown(\'drag-lb\', $event)" _v-379c5928=""></span> <span class="drag-point point-rt" @mousedown="pointMouseDown(\'drag-rt\', $event)" _v-379c5928=""></span> <span class="drag-point point-rb" @mousedown="pointMouseDown(\'drag-rb\', $event)" _v-379c5928=""></span> </div> </div> '},function(t,e){t.exports=' <div class=cropper-modal _v-5544aad5=""> <div class=overlay _v-5544aad5=""></div> <div class=modal _v-5544aad5=""> <div class=modal-head _v-5544aad5=""> <div class=head-wrap _v-5544aad5="">title</div> </div> <div class="modal-content clearfix" _v-5544aad5=""> <div class=img-clip-wrap _v-5544aad5=""> <div class=container-bg _v-5544aad5=""> <div class=img-container _v-5544aad5=""> <img id=clip_src_img @load=srcImgLoaded _v-5544aad5=""> <div class=shadow-box _v-5544aad5=""></div> <select-box v-ref:box="" :radio=radio :img=img _v-5544aad5=""></select-box> </div> </div> <div class=reset-img _v-5544aad5=""> <i class=icon-reset _v-5544aad5=""></i> <span _v-5544aad5="">select image</span> <input type=file id=file_input accept=image/* @change=fileChange _v-5544aad5=""> </div> </div> <div class=img-preview-wrap _v-5544aad5=""> <div class=pre-container _v-5544aad5=""> <img id=clip_res_img _v-5544aad5=""> </div> <div class=pre-info _v-5544aad5="">preview</div> </div> </div> <div class=modal-footer _v-5544aad5=""> <a class="modal-btn btn-confirm" :href=clipData download=crop.jpg _v-5544aad5="">clip</a> </div> </div> </div> '},function(t,e,i){var s,r;i(4),s=i(1),r=i(7),t.exports=s||{},t.exports.__esModule&&(t.exports=t.exports["default"]),r&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=r)},function(t,e,i){var s,r;i(6),s=i(2),r=i(9),t.exports=s||{},t.exports.__esModule&&(t.exports=t.exports["default"]),r&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=r)},function(t,e,i){var s,r;i(5),s=i(3),r=i(8),t.exports=s||{},t.exports.__esModule&&(t.exports=t.exports["default"]),r&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=r)}]);
//# sourceMappingURL=app.210b87ff6f9817dcdf29.js.map